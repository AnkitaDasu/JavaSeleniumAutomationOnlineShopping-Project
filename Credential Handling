

import java.io.FileInputStream;
import java.io.IOException;
import org.apache.poi.ss.usermodel.*;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

public class ToLearnCredentialHandling {

    public static final String RESET = "\u001B[0m";
    public static final String RED = "\u001B[31m";
    public static final String GREEN = "\u001B[32m";
    public static final String YELLOW = "\u001B[33m";
    public static final String CYAN = "\u001B[36m";
    public static final String BLUE = "\u001B[34m";
    public static final String BOLD = "\u001B[1m";

    public static void main(String[] args) throws IOException, InterruptedException {
        System.out.println(BLUE + BOLD + "========== STARTING DATA-DRIVEN LOGIN TEST ==========" + RESET);

        WebDriver driver = new ChromeDriver();
        driver.manage().window().maximize();
        driver.get("https://demoqa.com/login");

        FileInputStream file = new FileInputStream("C:\\Users\\91996\\Downloads\\demo.xlsx");
        Workbook workbook = WorkbookFactory.create(file);
        Sheet sheet = workbook.getSheetAt(0);

        System.out.println(YELLOW + "\nðŸ“˜ Reading test data from Excel..." + RESET);
        System.out.println(CYAN + "--------------------------------------------------" + RESET);

        
        for (int i = 1; i <= sheet.getLastRowNum(); i++) {
            String username = sheet.getRow(i).getCell(0).getStringCellValue();
            String password = sheet.getRow(i).getCell(1).getStringCellValue();
            String expectedResult = sheet.getRow(i).getCell(2).getStringCellValue();

            System.out.println(CYAN + "ðŸ”¹ Attempting login for: " + username + RESET);

            WebElement userField = driver.findElement(By.id("userName"));
            WebElement passField = driver.findElement(By.id("password"));
            WebElement loginBtn = driver.findElement(By.id("login"));

            userField.clear();
            passField.clear();
            userField.sendKeys(username);
            passField.sendKeys(password);
            loginBtn.click();

            Thread.sleep(2000);

            String actualResult;
            try {
                WebElement logoutBtn = driver.findElement(By.id("submit"));
                if (logoutBtn.isDisplayed()) {
                    actualResult = "Success";
                    logoutBtn.click();
                    Thread.sleep(1000);
                } else {
                    actualResult = "Failure";
                }
            } catch (Exception e) {
                actualResult = "Failure";
            }

            if (actualResult.equalsIgnoreCase(expectedResult)) {
                System.out.println(GREEN + "âœ… " + username + " â†’ Expected: " + expectedResult +
                        " | Actual: " + actualResult + " â†’ PASS" + RESET);
            } else {
                System.out.println(RED + "âŒ " + username + " â†’ Expected: " + expectedResult +
                        " | Actual: " + actualResult + " â†’ FAIL" + RESET);
            }

            System.out.println(CYAN + "--------------------------------------------------" + RESET);
            driver.navigate().to("https://demoqa.com/login");
            Thread.sleep(1000);
        }

        workbook.close();
        file.close();
        driver.quit();

        System.out.println(BLUE + BOLD + "\n========== TEST EXECUTION COMPLETED ==========" + RESET);
    }
}
